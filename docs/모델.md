모델 코드에서 forward와 generate가 동일한 과정을 가지면 좋겠습니다.\
이미지는 B,V,3,H,W를 가지는데 비전 인코더는 B*V,3,H,W로 입력을 변환하는 과정이 함수로 들어가고 출력은 비전 인코더의 last_hidden_dim입니다.\
resampler도 last_hidden_dim을 입력받아서 resampler결과를 리턴합니다.\
Projection는 B*V,L,D의 입력을 B,L*V,D로 변환하고(이때, B*V,H,W,D -> ?? -> B, H, V*W,D -> B, V*L,D)의 변환\\
변환된 결과를 projection layer를 통과시키고 그 결과를 리턴합니다.\
\
텍스트 토큰은 임베딩하고, 이미지 토큰 자리에 projection layer를 통과한 특징을 추가합니다.\
임베딩 된게 B, L',D_llm 이고 예를 들어 30번토큰이 이미지 토큰이라면 B, V*L,D_llm를 이미지 토큰 자리에 대체합니다.\
llm에 입력되는 임베딩은 B, L'-1 + V*L, D_llm이 됩니다.\
이 결과를 리턴하고 리턴한 결과를 학습시에는 llm forward, generate시에서는 llm generate를 통과시킵니다.